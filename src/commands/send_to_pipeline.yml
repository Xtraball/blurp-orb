description: |
  Blurp

parameters:
  pipeline_url:
    type: string
    default: ""
  pipeline_params:
    type: string
    default: "{}"
  pipeline_personal_token:
    type: string
    default: ""
  event:
    description: |
      In what event should this message send? Options: ["fail", "pass", "always"]
    type: enum
    enum: ["fail", "pass", "always"]
    default: "always"
steps:
  - run:
      when: on_fail
      name: Blurp - Detecting Job Status (FAIL)
      command: |
        echo 'export CCI_STATUS="fail"' > /tmp/BLURP_JOB_STATUS
  - run:
      when: on_success
      name: Blurp - Detecting Job Status (PASS)
      command: |
        echo 'export CCI_STATUS="pass"' > /tmp/BLURP_JOB_STATUS
  - run:
      when: always
      name: Blurp - Sending Notification
      command: <<include(scripts/notify.sh)>>
